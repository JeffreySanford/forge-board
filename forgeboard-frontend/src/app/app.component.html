<!-- Wrap the entire page in a black border container -->
<div class="page-container" [class.hide-border]="!showLayoutBorder" [class.hide-indicators]="!showContainerIndicators">
  <!-- Content wrapper with router outlet -->
  <div class="content-wrapper blue-border" [class.hide-border]="!showLayoutBorder">

    <mat-toolbar color="primary" class="header-containter" [class.hide-border]="!showLayoutBorder">
      {{ projectName }}
    </mat-toolbar>

    <app-navigation></app-navigation>

    <div class="fieldset-label content-label" *ngIf="showLayoutBorder">content container</div>

    <!-- Connection status indicator -->
    <app-connection-status-indicator position="top-right"></app-connection-status-indicator>

    <!-- Router outlet will display the current route component -->
    <router-outlet></router-outlet>

    <!-- Add footer component here -->
    <app-footer 
      [showContextBlock]="showContextBlock"
      [showLayoutBorder]="showLayoutBorder"
      [animationsStarted]="animationsStarted"
      [audioEnabled]="audioEnabled"
      [userData]="userData">
    </app-footer>

    <!-- Controls row -->
    <div class="controls-row">
      <!-- Add container indicator toggle button -->
      <div class="indicator-toggle mr-1" [class.active]="showContainerIndicators" (click)="toggleContainerIndicators()"
        title="Toggle container indicators">
        <mat-icon>label</mat-icon>
      </div>
      <!-- Rest of controls -->
      <div class="layout-icon mr-1" [class.shake]="layoutWiggle" (click)="toggleLayoutMode()"
        title="Toggle layout border and context block">
        <mat-icon>grid_on</mat-icon>
      </div>
      <div class="layout-icon mr-1" (click)="toggle12ColumnOverlay()" [class.active]="is12ColumnVisible"
        title="Toggle 12-column overlay">
        <mat-icon>view_column</mat-icon>
        <span class="layout-indicator">12</span>
      </div>
      <div class="layout-icon mr-1" (click)="toggle4ColumnOverlay()" [class.active]="is4ColumnVisible"
        title="Toggle 4-column overlay">
        <mat-icon>view_column</mat-icon>
        <span class="layout-indicator">4</span>
      </div>
      <div class="layout-icon mr-1" (click)="toggleSmallGridOverlay()" [class.active]="isSmallGridVisible"
        title="Toggle small background grid">
        <mat-icon>grid_view</mat-icon>
        <span class="layout-indicator">S</span>
      </div>
      <div class="layout-icon mr-1" (click)="toggleLargeGridOverlay()" [class.active]="isLargeGridVisible"
        title="Toggle large background grid">
        <mat-icon>grid_view</mat-icon>
        <span class="layout-indicator">L</span>
      </div>
      <!-- Audio control (furthest right) -->
      <div class="audio-icon" [class.shake]="isShaking" (click)="enableAudio()" title="Enable/Disable Audio">
        <mat-icon>{{ audioEnabled ? 'volume_up' : 'volume_off' }}</mat-icon>
      </div>
    </div>
  </div>
</div>

<!-- Layout overlays -->
<div class="layout-overlays">
  <div *ngIf="showLayoutBorder" class="layout-border-overlay"></div>
  <div *ngIf="is12ColumnVisible" class="layout-12col-overlay"></div>
  <div *ngIf="is4ColumnVisible" class="layout-4col-overlay"></div>
  <div *ngIf="isSmallGridVisible" class="layout-grid-overlay small"></div>
  <div *ngIf="isLargeGridVisible" class="layout-grid-overlay large"></div>
</div>

<!-- Audio elements -->
<audio #keyStrikeSound preload="auto" src="assets/sounds/typewriter/keystrike.mp3"></audio>
<audio #dingSound preload="auto" src="assets/sounds/typewriter/ding.mp3"></audio>
<!-- Note: Missing ambient sounds - add these files to prevent errors -->
<!-- <audio #ambientSound preload="auto" src="assets/sounds/typewriter/ambient.mp3"></audio> -->
<!-- <audio #starsAndStripesSound preload="auto" src="assets/sounds/typewriter/ambient-stars-and-stripes-forever-vocals.mp3"></audio> -->